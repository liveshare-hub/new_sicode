{% extends 'layouts/base.html' %}
{% load static %}

{% block tilte %}LIST KPJ{% endblock  %}

{% block stylesheets %}


{% endblock  %}

{% block breadcrumb %}

{% endblock  %}
{% block content %}

{% for message in messages  %}
  <div class="alert alert-warning" role="alert" id="warning-alert">
    {{message}}
  </div>
{% endfor %}

  <main class="c-main">
    <div class="container-fluid">
      <div class="fade-in">
        <div class="row">
          <div class="col-lg-xl">
            <div class="card">
              <div class="card-header"><i class="fa fa-align-justify"></i> List KPJ</div>
              <div class="card-body">
              
  
  <table id="example" class="table table-responsive table-bordered table-striped">
      <thead>
          <tr>
          <th scope="col">#</th>
          <th scope="col">Nama</th>
          <th scope="col">KPJ</th>
          <th scope="col">BLTH Keps.</th>
          <th scope="col">BLTH NA</th>
          <th scope="col">STATUS AKTIF</th>
          <th scope="col">ACTION</th>
          </tr>
    </thead>
    <tbody>
    {% for data in datas  %}
      <tr>
          <td>{{forloop.counter}}</td>
          <td><a href="{% url 'profile-tk' data.user_kpj.id%}">{{data.user_kpj.nama}}</a></td>
          <td>{{data.no_kpj}}</td>
          {% if data.blth_keps %}
          <td>{{data.blth_keps}}</td>
          {% else %}
          <td></td>
          {% endif %}
          {% if data.blth_na %}
          <td>{{data.blth_na}}</td>
          {% else %}
          <td></td>
          {% endif %}
          {% if data.is_aktif %}
          <td>Y</td>
          {% else %}
          <td>T</td>
          {% endif %}
          <td><a href="{% url 'update_profile' data.user_kpj.id%}" class="btn btn-sm btn-warning mx-2">edit</a><a href="{% url 'add-kpj' data.user_kpj.id%}" class="btn btn-sm btn-success">add kpj</td>
      </tr>
      
    {% endfor %}
    
    </tbody>
    
  </table>

  <a href="{% url 'daftar-kpj' %}" class="btn btn-sm btn-info float-right mt-2">ADD TK</a>

</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
{% endblock  %}

{% block javascripts %}
<script>
$(document).ready(function() {
    
   var t = $('#example').DataTable( {
        dom: 'Bfrtip',
        buttons: [
            {
                extend:'pdfHtml5',
                orientation: 'landscape',
                pageSize:'LEGAL'
            },
            {
                extend: 'excelHtml5',
                customize: function ( xlsx ){
                var size = document.getElementById('size').value
                console.log(size)
                
                var sheet = xlsx.xl.worksheets['sheet1.xml']
                for(i = 2;i<=size+2;i++){
                    
                // jQuery selector to add a border
                    $(`row c[r*="${i}"]`, sheet).attr( 's', '25' );
                }
            }
            }
        ],
        
        columnDefs: [ {
            "defaultContent": "-",
            sortable: false,
            "class": "number",
            
            targets: 0
        } ],
        order: [[ 8, 'asc' ]],
        fixedColumns:true
    } );
        
    t.on( 'order.dt search.dt', function () {
        t.column(0, {search:'applied', order:'applied'}).nodes().each( function (cell, i) {
            cell.innerHTML = i+1;
        } );
    } ).draw();
} );
</script>
<script>
$("#warning-alert").fadeTo(2000, 500).slideUp(500, function(){
    $("#warning-alert").slideUp(500);
});
</script>

{% endblock javascripts %}