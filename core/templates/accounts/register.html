{% extends "layouts/base-fullscreen.html" %}

{% block title %} Login {% endblock %} 

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}{% endblock stylesheets %}

{% block content %}

  <div class="row justify-content-center">
    <div class="col-md-8">
      <div class="card-group">
        <div class="card p-4">
          <div class="card-body">
            <h1>Register</h1>
            <p class="text-muted">

              {% if msg %}
                {{ msg | safe }}
              {% else %}              
                Create your account
              {% endif %}  
            </p>

            <form role="form" method="post" action="">

              {% csrf_token %} 
              
              <div class="input-group mb-3">
                <div class="input-group-prepend"><span class="input-group-text">
                    <svg class="c-icon">
                      <use xlink:href="/static/assets/vendors/@coreui/icons/svg/free.svg#cil-magnifying-glass"></use>
                    </svg></span></div>
                    <input type="text" id="id_npp" class="form-control" placeholder="NPP">
                    
              </div>
              <div class="input-group mb-3">  
                <input type="text" id="id_hasil_npp" name="hasil_npp" class="form-control" disabled>
                
              </div>
              <div class="input-group mb-3">
              <input type="text" id="id_no_npp" name="no_npp" class="form-control" disabled>
              </div>
              <div class="input-group mb-3">
                <div class="input-group-prepend"><span class="input-group-text">
                    <svg class="c-icon">
                      <use xlink:href="/static/assets/vendors/@coreui/icons/svg/free.svg#cil-user"></use>
                    </svg></span></div>
                    {{ form.username }}
              </div>
              <span class="text-error">{{ form.username.errors }}</span>

              <div class="input-group mb-3">
                <div class="input-group-prepend"><span class="input-group-text">
                    <svg class="c-icon">
                      <use xlink:href="/static/assets/vendors/@coreui/icons/svg/free.svg#cil-settings"></use>
                    </svg></span></div>
                    {{ form.password1 }}
              </div>  
              <span class="text-error">{{ form.password1.errors }}</span>

              <div class="input-group mb-3">
                <div class="input-group-prepend"><span class="input-group-text">
                    <svg class="c-icon">
                      <use xlink:href="/static/assets/vendors/@coreui/icons/svg/free.svg#cil-settings"></use>
                    </svg></span></div>
                    {{ form.password2 }}
              </div>  
              <span class="text-error">{{ form.password2.errors }}</span>

              <div class="row">
                <div class="col-6">
                  <button type="submit" name="register" class="btn btn-primary px-4">Register</button>
                </div>
                <div class="col-6 text-right">
                  <a href={% url 'login' %} class="btn btn-link px-0">Login</a>
                </div>
              </div>
            
            </form> 

          </div>
        </div>
        <div class="card text-white bg-primary py-5 d-md-down-none" style="width:44%">
          <div class="card-body text-center">
            <div>
              
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}
<script>

var namaNpp = ``


$(document).ready(function() {
  $("div input#id_hasil_npp").hide();
  
  $("#id_npp").on("keyup", function(event){
    $(this).val($(this).val().toUpperCase());
    event.preventDefault();
    $("div input#id_hasil_npp").show();
    $("div input#id_no_npp").show();
    var value = $(this).val().toUpperCase();
    $.ajax({
      type:'GET',
      url:"{% url 'api-perusahaan' %}" + `?search=${value}`,
      async: true,
      success:function(data){
        if(data.length > 0) {
          $("#id_hasil_npp").attr("value",`${data[0]['nama']}`)
          $("#id_no_npp").attr("value",`${data[0]['id']}`)
          
        }
        else{
          $("#id_hasil_npp").val("NPP Tidak Ditemukan!!!")
        }
      },
      error: function(xhr, status, error){
        var err = JSON.parse(xhr.responseText);
        console.log(status)
        alert(err)
      }
    });
  
});
})


</script>



{% endblock javascripts %}
